name: Notify DISCORD on PR Comment

on:
  issue_comment:
    types: [created, edited]

jobs:
  Notify-PR-Comment:
    if: github.event.issue.pull_request != null
    runs-on: ubuntu-latest
    steps:
      - name: Send Discord message
        run: |
          COMMENT_URL="${{ github.event.comment.html_url }}"
          AUTHOR="${{ github.event.comment.user.login }}"
          BODY='${{ github.event.comment.body }}'
          ESCAPED_BODY=$(echo "$BODY" | sed 's/"/\\"/g')
          PR_TITLE='${{ github.event.issue.title }}'
          ESCAPED_TITLE=$(echo "$PR_TITLE" | sed 's/"/\\\"/g')

          curl -i -H 'Accept: application/json' \
          -H 'Content-Type: application/json' \
          -X POST -d "{
            \"content\": \"ğŸ’¬ [**${ESCAPED_TITLE}**]  PRì— ëŒ“ê¸€ì´ ë‹¬ë ¸ìŠµë‹ˆë‹¤!\n*ì‘ì„±ì:* ${AUTHOR}\n*ë‚´ìš©:* ${ESCAPED_BODY}\n<${COMMENT_URL}|ëŒ“ê¸€ ë³´ê¸°>\"
          }" \
          ${{ secrets.DISCORD_WEBHOOK }}
